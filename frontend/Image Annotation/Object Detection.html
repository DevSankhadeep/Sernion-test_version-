<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Object Detection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 'custom-purple': '#5e0fe7' }
        }
      }
    }
  </script>
  <style>
    .bbox { 
      position:absolute; 
      border:2px solid; 
      cursor:move; 
      background:rgba(0,0,0,0.1); }
    .bbox:hover { 
      box-shadow: 0 0 10px rgba(37,99,235,0.5); }
    .bbox-label { 
      position:absolute; 
      top:-20px; 
      left:0; 
      color:white;
      padding:2px 6px; 
      font-size:11px; 
      border-radius:3px; }
  </style>
</head>
<body class="bg-slate-50 font-sans text-gray-900 overflow-hidden">
  
  <!-- Header -->
  <header class="flex items-center justify-between px-4 py-3 bg-white border-b border-gray-200">
    <div class="flex items-center gap-3">
      <svg class="w-5 h-5" viewBox="0 0 24 24">
        <path fill="#2563eb" d="M4 3h16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/>
        <circle cx="8" cy="8" r="2.25" fill="#fff"/>
        <path fill="#93c5fd" d="M3 18l6-6 3 3 3-4 6 7v1H3z"/>
      </svg>
      <div>
        <h1 id="fileName" class="text-sm font-bold">Image.png</h1>
        <div class="text-xs text-gray-500">Object Detection</div>
      </div>
    </div>
    <div class="flex gap-2">
      <button class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-gray-700 text-sm font-medium hover:bg-gray-50">
        <a href="/frontend/Datasets.html">‚Üê Back to project</a>
      </button>
      <button id="saveBtn" class="inline-flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md text-sm font-medium hover:bg-gray-800">üîíSave</button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="grid grid-cols-1 xl:grid-cols-4 gap-4 p-4 h-screen">
    
    <!-- Left Section -->
    <section class="xl:col-span-3 bg-white border border-gray-200 rounded-xl p-4 flex flex-col items-center justify-center">
      
      <!-- Upload Area -->
      <div id="card" class="border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 w-full max-w-4xl h-80 md:h-96 lg:h-[460px] flex items-center justify-center cursor-pointer transition-all duration-200 hover:border-blue-600 hover:bg-blue-50">
        <div id="stack" class="flex flex-col gap-3 items-center w-full h-full">
          <div id="hint" class="text-gray-500 text-center p-5 text-base font-medium">Click to select, or drop an image</div>
        </div>
        <input id="file" type="file" accept="image/*" class="absolute w-px h-px opacity-0 pointer-events-none" />
      </div>

      <!-- Controls -->
      <div class="flex flex-wrap gap-3 justify-center mt-4">
        <button id="drawBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-blue-700 transition-colors">‚úèÔ∏è Draw</button>
        <button id="clearBtn" class="bg-red-50 text-red-800 px-4 py-2 rounded-lg font-bold hover:bg-red-100 transition-colors">üóëÔ∏è Clear</button>
        <button id="undoBtn" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-bold hover:bg-gray-300 transition-colors opacity-50 cursor-not-allowed" disabled>‚Ü∂ Undo</button>
      </div>

      <!-- URL Input -->
      <div class="flex gap-2 justify-center mt-3">
        <input id="urlInput" class="flex-1 max-w-md px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Paste image URL" />
        <button id="addUrl" class="px-4 py-2 border border-blue-600 text-blue-600 bg-blue-50 rounded-lg font-bold hover:bg-blue-100 transition-colors">Add</button>
      </div>

      <div id="fileInfo" class="mt-2 text-center text-gray-500 text-sm">No image selected</div>
    </section>

    <!-- Right Sidebar -->
    <aside class="bg-white border border-gray-200 rounded-xl p-4 overflow-y-auto">
      
      <!-- Object Classes -->
      <div class="mb-4">
        <h3 class="text-lg font-bold mb-3">Object Classes</h3>
        <div class="space-y-3">
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-red-500">Person</span>
            <button class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold" data-type="Person">Select</button>
          </div>
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-blue-600">Vehicle</span>
            <button class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold" data-type="Vehicle">Select</button>
          </div>
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-green-600">Animal</span>
            <button class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold" data-type="Animal">Select</button>
          </div>
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-amber-500">Object</span>
            <button class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold" data-type="Object">Select</button>
          </div>
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-violet-600">Building</span>
            <button class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold" data-type="Building">Select</button>
          </div>
        </div>
      </div>

      <!-- Detection Controls -->
      <div>
        <h3 class="text-lg font-bold mb-3">Detection Controls</h3>
        <div class="space-y-3">
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-green-600">Start Detection</span>
            <button id="modeAdd" class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold">Enable</button>
          </div>
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-blue-600">Auto Detect</span>
            <button id="modeConnect" class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold">Enable</button>
          </div>
          <div class="flex items-center justify-between border border-gray-200 rounded-lg bg-white p-3 shadow-sm hover:shadow-md transition-shadow">
            <span class="font-bold text-base text-red-500">Delete selected</span>
            <button id="modeDelete" class="border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold">Enable</button>
          </div>
        </div>
      </div>
    </aside>
  </main>

<script>
  // State
  let activeImage = null, drawMode = false, detectMode = false, deleteMode = false, autoDetect = false;
  let currentType = 'Person', bboxes = [], isDrawing = false, startX = 0, startY = 0, currentBbox = null;
  let history = [], drawingCanvas = null, drawingCtx = null, pencilMode = false, isPencilDrawing = false, pencilHistory = [];

  // Object colors
  const objColors = { 'Person': '#ef4444', 'Vehicle': '#3b82f6', 'Animal': '#10b981', 'Object': '#f59e0b', 'Building': '#8b5cf6' };

  // Elements
  const card = document.getElementById('card'), stack = document.getElementById('stack'), fileInput = document.getElementById('file');
  const hint = document.getElementById('hint'), fileInfo = document.getElementById('fileInfo'), urlInput = document.getElementById('urlInput'), fileName = document.getElementById('fileName');

  // Drawing Canvas Functions
  function createDrawingCanvas(container) {
    const existing = container.querySelector('canvas');
    if (existing) existing.remove();
    
    const canvas = document.createElement('canvas');
    canvas.style.cssText = 'position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:auto;cursor:crosshair;z-index:10;';
    
    const img = container.querySelector('img');
    if (img) {
      canvas.width = img.naturalWidth;
      canvas.height = img.naturalHeight;
      canvas.style.width = img.offsetWidth + 'px';
      canvas.style.height = img.offsetHeight + 'px';
    }
    
    container.appendChild(canvas);
    return canvas;
  }

  function getPos(e, canvas) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width, scaleY = canvas.height / rect.height;
    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
    return [(clientX - rect.left) * scaleX, (clientY - rect.top) * scaleY];
  }

  function startPencilDraw(e) {
    if (!pencilMode || !drawingCanvas) return;
    isPencilDrawing = true;
    const [x, y] = getPos(e, drawingCanvas);
    drawingCtx.beginPath();
    drawingCtx.moveTo(x, y);
    e.preventDefault();
  }

  function pencilDraw(e) {
    if (!isPencilDrawing || !pencilMode) return;
    const [x, y] = getPos(e, drawingCanvas);
    drawingCtx.lineTo(x, y);
    drawingCtx.stroke();
    e.preventDefault();
  }

  function stopPencilDraw(e) {
    if (!isPencilDrawing) return;
    isPencilDrawing = false;
    savePencilState();
    e.preventDefault();
  }

  function savePencilState() {
    pencilHistory.push(drawingCanvas.toDataURL());
    if (pencilHistory.length > 50) pencilHistory.shift();
    updateUndoBtn();
  }

  function undoPencil() {
    if (pencilHistory.length < 2) return;
    pencilHistory.pop();
    const lastState = pencilHistory[pencilHistory.length - 1];
    if (lastState) {
      const img = new Image();
      img.onload = () => {
        drawingCtx.clearRect(0, 0, drawingCanvas.width, drawingCanvas.height);
        drawingCtx.drawImage(img, 0, 0);
      };
      img.src = lastState;
    } else {
      drawingCtx.clearRect(0, 0, drawingCanvas.width, drawingCanvas.height);
    }
    updateUndoBtn();
  }

  function clearPencil() {
    if (!drawingCanvas) return;
    if (confirm('Clear all drawings?')) {
      drawingCtx.clearRect(0, 0, drawingCanvas.width, drawingCanvas.height);
      pencilHistory = [''];
      updateUndoBtn();
    }
  }

  // Bounding Box Functions
  function createBbox(x, y, w, h, type) {
    const bbox = document.createElement('div');
    bbox.className = 'bbox';
    bbox.style.cssText = `left:${x}px; top:${y}px; width:${w}px; height:${h}px; border-color:${objColors[type]}; background:${objColors[type]}20; z-index:5;`;
    bbox.dataset.type = type;
    bbox.dataset.id = Date.now();

    const label = document.createElement('div');
    label.className = 'bbox-label';
    label.textContent = type;
    label.style.background = objColors[type];
    bbox.appendChild(label);

    bbox.onclick = (e) => {
      e.stopPropagation();
      deleteMode ? removeBbox(bbox) : selectBbox(bbox);
    };

    return bbox;
  }

  function removeBbox(bbox) {
    bboxes = bboxes.filter(b => b.id !== bbox.dataset.id);
    bbox.remove();
    saveState();
  }

  function selectBbox(bbox) {
    document.querySelectorAll('.bbox').forEach(b => b.style.boxShadow = '');
    bbox.style.boxShadow = '0 0 0 2px #10b981';
  }

  function startDrawing(e) {
    if (pencilMode || !detectMode || !activeImage) return;
    
    const rect = activeImage.container.getBoundingClientRect();
    startX = e.clientX - rect.left;
    startY = e.clientY - rect.top;
    isDrawing = true;

    currentBbox = document.createElement('div');
    currentBbox.style.cssText = `position:absolute; border:2px dashed ${objColors[currentType]}; background:${objColors[currentType]}20; left:${startX}px; top:${startY}px; width:0; height:0; pointer-events:none; z-index:5;`;
    activeImage.container.appendChild(currentBbox);
    e.preventDefault();
  }

  function drawBbox(e) {
    if (pencilMode || !isDrawing || !currentBbox) return;
    
    const rect = activeImage.container.getBoundingClientRect();
    const currentX = e.clientX - rect.left;
    const currentY = e.clientY - rect.top;
    
    const left = Math.min(startX, currentX);
    const top = Math.min(startY, currentY);
    const width = Math.abs(currentX - startX);
    const height = Math.abs(currentY - startY);
    
    currentBbox.style.cssText += `left:${left}px; top:${top}px; width:${width}px; height:${height}px;`;
    e.preventDefault();
  }

  function endDrawing(e) {
    if (pencilMode || !isDrawing || !currentBbox) return;
    
    const width = parseFloat(currentBbox.style.width);
    const height = parseFloat(currentBbox.style.height);
    
    if (width > 20 && height > 20) {
      const left = parseFloat(currentBbox.style.left);
      const top = parseFloat(currentBbox.style.top);
      
      currentBbox.remove();
      const bbox = createBbox(left, top, width, height, currentType);
      activeImage.container.appendChild(bbox);
      bboxes.push({ element: bbox, x: left, y: top, w: width, h: height, type: currentType, id: bbox.dataset.id });
      saveState();
    } else {
      currentBbox.remove();
    }
    
    isDrawing = false;
    currentBbox = null;
    e.preventDefault();
  }

  function clearAll() {
    if (!activeImage) return;
    if (pencilMode) {
      clearPencil();
    } else if (bboxes.length > 0) {
      if (confirm('Clear all bounding boxes?')) {
        document.querySelectorAll('.bbox').forEach(el => el.remove());
        bboxes = [];
        saveState();
      }
    }
  }

  function saveState() {
    history.push([...bboxes]);
    if (history.length > 50) history.shift();
    updateUndoBtn();
  }

  function undo() {
    if (pencilMode) {
      undoPencil();
    } else {
      if (history.length < 2) return;
      history.pop();
      const lastState = history[history.length - 1] || [];
      
      document.querySelectorAll('.bbox').forEach(el => el.remove());
      bboxes = [];
      
      lastState.forEach(bboxData => {
        const bbox = createBbox(bboxData.x, bboxData.y, bboxData.w, bboxData.h, bboxData.type);
        bbox.dataset.id = bboxData.id;
        activeImage.container.appendChild(bbox);
        bboxes.push(bboxData);
      });
      
      updateUndoBtn();
    }
  }

  function updateUndoBtn() {
    const btn = document.getElementById('undoBtn');
    const hasHistory = pencilMode ? pencilHistory.length > 1 : history.length > 1;
    btn.disabled = !hasHistory;
    btn.classList.toggle('opacity-50', !hasHistory);
    btn.classList.toggle('cursor-not-allowed', !hasHistory);
  }

  // Event Listeners
  document.querySelectorAll('[data-type]').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('[data-type]').forEach(b => b.className = 'border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold');
      btn.className = 'border border-blue-500 rounded-md px-3 py-2 bg-blue-50 text-xs font-semibold';
      currentType = btn.dataset.type;
    });
  });

  // Mode toggles
  document.getElementById('modeAdd').addEventListener('click', (e) => {
    detectMode = !detectMode;
    e.target.textContent = detectMode ? 'Disable' : 'Enable';
    e.target.className = detectMode ? 'border border-green-500 rounded-md px-3 py-2 bg-green-50 text-xs font-semibold text-green-700' : 'border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold';
    if (detectMode) { autoDetect = deleteMode = false; updateModeButtons(); }
  });

  document.getElementById('modeConnect').addEventListener('click', (e) => {
    autoDetect = !autoDetect;
    e.target.textContent = autoDetect ? 'Disable' : 'Enable';
    e.target.className = autoDetect ? 'border border-blue-500 rounded-md px-3 py-2 bg-blue-50 text-xs font-semibold text-blue-700' : 'border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold';
    if (autoDetect) { detectMode = deleteMode = false; updateModeButtons(); }
  });

  document.getElementById('modeDelete').addEventListener('click', (e) => {
    deleteMode = !deleteMode;
    e.target.textContent = deleteMode ? 'Disable' : 'Enable';
    e.target.className = deleteMode ? 'border border-red-500 rounded-md px-3 py-2 bg-red-50 text-xs font-semibold text-red-700' : 'border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold';
    if (deleteMode) { detectMode = autoDetect = false; updateModeButtons(); }
  });

  function updateModeButtons() {
    const buttons = ['modeAdd', 'modeConnect', 'modeDelete'];
    const modes = [detectMode, autoDetect, deleteMode];
    buttons.forEach((id, i) => {
      const btn = document.getElementById(id);
      if (!modes[i]) {
        btn.textContent = 'Enable';
        btn.className = 'border border-gray-300 rounded-md px-3 py-2 bg-white text-xs font-semibold';
      }
    });
  }

  card.addEventListener('click', (e) => {
    if (activeImage?.container && (activeImage.container === e.target || activeImage.container.contains(e.target))) {
      return; // Allow drawing on image
    }
    fileInput.click();
  });

  fileInput.addEventListener('change', (e) => {
    if (e.target.files && e.target.files.length) loadFile(e.target.files[0]);
  });

  // Drag & Drop
  ['dragenter', 'dragover'].forEach(e => card.addEventListener(e, (ev) => {
    ev.preventDefault();
    card.className = 'border-2 border-dashed border-blue-600 rounded-xl bg-blue-50 w-full max-w-4xl h-80 md:h-96 lg:h-[460px] flex items-center justify-center cursor-pointer transition-all duration-200';
    hint.textContent = 'Drop your image here';
  }));

  card.addEventListener('dragleave', (e) => {
    e.preventDefault();
    card.className = 'border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 w-full max-w-4xl h-80 md:h-96 lg:h-[460px] flex items-center justify-center cursor-pointer transition-all duration-200 hover:border-blue-600 hover:bg-blue-50';
    hint.textContent = 'Click to select, or drop an image';
  });

  card.addEventListener('drop', (e) => {
    e.preventDefault();
    card.ondragleave(e);
    if (e.dataTransfer.files?.[0]) loadFile(e.dataTransfer.files[0]);
  });

  document.getElementById('addUrl').addEventListener('click', () => {
    const url = urlInput.value.trim();
    if (url) {
      hint.textContent = 'Loading from URL...';
      hint.className = 'text-blue-600 text-center p-5 text-base font-semibold';
      createImage(url, 'Image from URL');
      urlInput.value = '';
    }
  });

  document.getElementById('drawBtn').addEventListener('click', () => {
    if (!activeImage) return alert('Please upload an image first!');
    
    drawMode = !drawMode;
    const btn = document.getElementById('drawBtn');
    
    if (drawMode) {
      btn.textContent = '‚è∏Ô∏è Stop';
      btn.className = 'bg-red-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-red-700 transition-colors';
      
      // Enable pencil mode
      pencilMode = true;
      drawingCanvas = createDrawingCanvas(activeImage.container);
      drawingCtx = drawingCanvas.getContext('2d');
      drawingCtx.strokeStyle = objColors[currentType];
      drawingCtx.lineWidth = 3;
      drawingCtx.lineCap = 'round';
      drawingCtx.lineJoin = 'round';
      
      // Add drawing event listeners
      drawingCanvas.addEventListener('mousedown', startPencilDraw);
      drawingCanvas.addEventListener('mousemove', pencilDraw);
      drawingCanvas.addEventListener('mouseup', stopPencilDraw);
      drawingCanvas.addEventListener('mouseleave', stopPencilDraw);
      drawingCanvas.addEventListener('touchstart', startPencilDraw);
      drawingCanvas.addEventListener('touchmove', pencilDraw);
      drawingCanvas.addEventListener('touchend', stopPencilDraw);
      
      pencilHistory = [''];
      updateUndoBtn();
    } else {
      btn.textContent = '‚úèÔ∏è Draw';
      btn.className = 'bg-blue-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-blue-700 transition-colors';
      
      // Disable pencil mode
      pencilMode = false;
      if (drawingCanvas) {
        drawingCanvas.remove();
        drawingCanvas = drawingCtx = null;
      }
      pencilHistory = [];
      updateUndoBtn();
    }
  });

  document.getElementById('clearBtn').addEventListener('click', () => {
    if (!activeImage) return alert('Please upload an image first!');
    clearAll();
  });

  document.getElementById('undoBtn').addEventListener('click', () => {
    if (!activeImage) return alert('Please upload an image first!');
    undo();
  });

  document.getElementById('saveBtn').addEventListener('click', () => {
    if (!activeImage) return alert('No image to save!');
    
    const data = {
      timestamp: new Date().toISOString(),
      currentType,
      detections: bboxes.map(b => ({ x: b.x, y: b.y, w: b.w, h: b.h, type: b.type, id: b.id })),
      drawingData: drawingCanvas ? drawingCanvas.toDataURL() : null,
      imageName: activeImage.name,
      imageData: activeImage.src
    };

    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `object_detection_${Date.now()}.json`;
    a.click();
    URL.revokeObjectURL(url);
    alert('Object detection saved successfully!');
  });

  // Helper Functions
  function loadFile(file) {
    if (!file.type.startsWith('image/')) return alert('Please select an image file');
    
    hint.textContent = 'Loading...';
    hint.className = 'text-blue-600 text-center p-5 text-base font-semibold';

    const reader = new FileReader();
    reader.onload = (e) => createImage(e.target.result, file.name);
    reader.onerror = () => {
      hint.textContent = 'Failed to load image';
      hint.className = 'text-red-600 text-center p-5 text-base font-semibold';
    };
    reader.readAsDataURL(file);
  }

  function createImage(src, name) {
    // Reset modes when new image loads
    if (drawMode) {
      drawMode = detectMode = pencilMode = false;
      if (drawingCanvas) {
        drawingCanvas.remove();
        drawingCanvas = drawingCtx = null;
      }
      const drawBtn = document.getElementById('drawBtn');
      drawBtn.textContent = '‚úèÔ∏è Draw';
      drawBtn.className = 'bg-blue-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-blue-700 transition-colors';
      updateModeButtons();
    }

    hint.remove();
    const container = document.createElement('div');
    container.className = 'relative flex items-center justify-center w-full h-full rounded-lg overflow-hidden';

    // Add drawing listeners for bounding boxes
    container.addEventListener('mousedown', startDrawing);
    container.addEventListener('mousemove', drawBbox);
    container.addEventListener('mouseup', endDrawing);
    container.addEventListener('mouseleave', endDrawing);

    const img = new Image();
    img.onload = () => {
      img.className = 'max-w-full max-h-full w-auto h-auto rounded-lg shadow-lg';
      container.appendChild(img);
      stack.appendChild(container);
      activeImage = { container, img, name, src };
      fileName.textContent = name;
      fileInfo.innerHTML = `Loaded: <b>${name}</b>`;
      bboxes = [];
      history = [[]];
      pencilHistory = [];
      updateUndoBtn();
    };
    img.onerror = () => stack.innerHTML = '<div class="text-red-600 text-center p-5 text-base font-semibold">Failed to load image</div>';
    img.src = src;
  }

  // Initialize
  document.querySelector('[data-type="Person"]').click();
</script>
</body>
</html>
